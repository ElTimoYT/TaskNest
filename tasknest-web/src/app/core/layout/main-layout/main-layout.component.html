<div class="min-h-screen bg-slate-50 dark:bg-slate-900 font-sans selection:bg-indigo-100 selection:text-indigo-900 flex overflow-hidden transition-colors duration-300">
  
  <aside class="hidden md:flex flex-col w-72 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-r border-slate-200/80 dark:border-slate-800 fixed inset-y-0 left-0 z-50 p-5">
    
    <div class="flex shrink-0 items-center gap-3 px-2 mb-8 cursor-pointer group" routerLink="/dashboard">
      <div class="h-10 w-10 shrink-0 bg-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-indigo-600/30 group-hover:shadow-indigo-600/50 transition-all group-hover:-translate-y-0.5">
        <mat-icon class="text-white !h-6 !w-6 !text-[24px]">task_alt</mat-icon>
      </div>
      <span class="text-2xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-400 tracking-tight">
        TaskNest
      </span>
    </div>

    <nav class="flex-1 space-y-3 overflow-y-auto pr-2 min-h-0">
      <a routerLink="/dashboard" 
         routerLinkActive="!bg-indigo-50 dark:!bg-indigo-900/30 !text-indigo-700 dark:!text-indigo-300 shadow-sm" 
         [routerLinkActiveOptions]="{exact: true}"
         class="text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 hover:bg-slate-100/50 dark:hover:bg-slate-800/50 px-4 py-3.5 rounded-xl text-sm font-bold transition-all flex items-center gap-4 group">
        <mat-icon class="transition-transform group-hover:scale-110">space_dashboard</mat-icon>
        Dashboard
      </a>
      
      <a routerLink="/tasks" 
         routerLinkActive="!bg-indigo-50 dark:!bg-indigo-900/30 !text-indigo-700 dark:!text-indigo-300 shadow-sm"
         class="text-slate-500 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 hover:bg-slate-100/50 dark:hover:bg-slate-800/50 px-4 py-3.5 rounded-xl text-sm font-bold transition-all flex items-center gap-4 group">
        <mat-icon class="transition-transform group-hover:scale-110">list_alt</mat-icon>
        Mis Tareas
      </a>
    </nav>

    <div class="mt-4 pt-4 mb-4 border-t border-slate-200/80 dark:border-slate-800 shrink-0 flex flex-col gap-2">
      
      <button (click)="toggleTheme()" 
              class="flex items-center justify-between px-3 py-2 rounded-lg text-xs font-bold transition-colors border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 dark:bg-slate-800 dark:hover:text-white">
        <div class="flex items-center gap-2">
          <mat-icon class="!text-[16px] !h-[16px] !w-[16px]">{{ isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
          <span>Tema Visual</span>
        </div>
        <span class="bg-slate-200 dark:bg-slate-700 text-[10px] px-1.5 py-0.5 rounded">{{ isDarkMode() ? 'OSCURO' : 'CLARO' }}</span>
      </button>

      <div [matMenuTriggerFor]="profileMenu" class="flex items-center justify-between p-2 rounded-xl hover:bg-slate-100/50 dark:hover:bg-slate-800/50 cursor-pointer transition-all group">
        <div class="flex items-center gap-3">
          <div class="h-10 w-10 shrink-0 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm shadow-md group-hover:scale-105 transition-transform">
            {{ userInitials }}
          </div>
          <div class="flex flex-col items-start overflow-hidden">
            <span class="text-sm font-bold text-slate-700 dark:text-slate-200 leading-none mb-1 truncate w-24">Mi Cuenta</span>
            <span class="text-[10px] font-semibold text-slate-400 dark:text-slate-500 tracking-wide uppercase">Ajustes</span>
          </div>
        </div>
        <mat-icon class="text-slate-400 dark:text-slate-500 text-sm h-5 w-5 shrink-0 group-hover:text-indigo-500 transition-colors">more_vert</mat-icon>
      </div>
      
    </div>
  </aside>

  <header class="md:hidden fixed top-0 left-0 right-0 w-full bg-white/90 dark:bg-slate-900/90 backdrop-blur-md border-b border-slate-200/80 dark:border-slate-800 z-50 flex justify-between items-center h-16 px-4 box-border">
    <div class="flex items-center gap-2 truncate">
      <div class="h-8 w-8 shrink-0 bg-indigo-600 rounded-lg flex items-center justify-center shadow-md">
        <mat-icon class="text-white !h-5 !w-5 !text-[20px]">task_alt</mat-icon>
      </div>
      <span class="text-xl font-extrabold bg-clip-text text-transparent bg-gradient-to-r from-indigo-700 to-purple-600 dark:from-indigo-400 dark:to-purple-400 truncate">TaskNest</span>
    </div>
    
    <div class="flex items-center gap-3">
      <button (click)="toggleTheme()" class="text-slate-500 dark:text-slate-400 h-8 w-8 flex items-center justify-center rounded-full hover:bg-slate-100 dark:hover:bg-slate-800">
        <mat-icon class="!text-[20px] !h-[20px] !w-[20px]">{{ isDarkMode() ? 'light_mode' : 'dark_mode' }}</mat-icon>
      </button>
      
      <div [matMenuTriggerFor]="profileMenu" class="h-8 w-8 shrink-0 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-xs shadow-md cursor-pointer">
        {{ userInitials }}
      </div>
    </div>
  </header>

  <nav class="md:hidden fixed bottom-0 left-0 right-0 w-full bg-white/95 dark:bg-slate-900/95 backdrop-blur-lg border-t border-slate-200/80 dark:border-slate-800 z-50 flex justify-around items-center h-16 pb-1 box-border">
    <a routerLink="/dashboard" routerLinkActive="text-indigo-600 dark:text-indigo-400" [routerLinkActiveOptions]="{exact: true}" class="text-slate-400 dark:text-slate-500 flex flex-col items-center p-2">
      <mat-icon>space_dashboard</mat-icon>
      <span class="text-[10px] font-bold mt-1">Inicio</span>
    </a>
    <a routerLink="/tasks" routerLinkActive="text-indigo-600 dark:text-indigo-400" class="text-slate-400 dark:text-slate-500 flex flex-col items-center p-2">
      <mat-icon>list_alt</mat-icon>
      <span class="text-[10px] font-bold mt-1">Tareas</span>
    </a>
    <a routerLink="/settings" routerLinkActive="text-indigo-600 dark:text-indigo-400" class="text-slate-400 dark:text-slate-500 flex flex-col items-center p-2">
      <mat-icon>settings</mat-icon>
      <span class="text-[10px] font-bold mt-1">Ajustes</span>
    </a>
  </nav>

  <main class="flex-1 w-full md:ml-72 pt-16 md:pt-0 pb-16 md:pb-0 min-h-[100dvh]">
    <div class="h-full">
      <router-outlet></router-outlet>
    </div>
  </main>
  
  <mat-menu #profileMenu="matMenu" class="!rounded-2xl min-w-[240px] !p-2 !shadow-xl !shadow-slate-200/50 dark:!shadow-none border border-slate-100 dark:border-slate-700 bg-white dark:bg-slate-800">
    <div class="px-4 py-3 mb-2 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-100 dark:border-slate-700">
      <p class="text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-wider mb-1">Conectado como</p>
      <div class="flex items-center gap-2">
        <div class="h-6 w-6 shrink-0 rounded-full bg-indigo-100 dark:bg-indigo-900/50 text-indigo-700 dark:text-indigo-300 flex items-center justify-center text-xs font-bold">{{ userInitials }}</div>
        <p class="text-sm font-bold text-slate-800 dark:text-slate-200 truncate">{{ usernameDisplay }}</p>
      </div>
    </div>
    
    <button mat-menu-item routerLink="/settings" class="!rounded-xl hover:!bg-indigo-50 dark:hover:!bg-slate-700 transition-colors !h-12 hidden md:flex">
      <mat-icon class="text-slate-400 dark:text-slate-400">tune</mat-icon>
      <span class="font-semibold dark:text-slate-200">Ajustes de cuenta</span>
    </button>
    <mat-divider class="!my-2 !border-slate-100 dark:!border-slate-700 hidden md:block"></mat-divider>
    
    <button mat-menu-item (click)="logout()" class="!rounded-xl !text-rose-600 dark:!text-rose-400 hover:!bg-rose-50 dark:hover:!bg-rose-900/20 transition-colors !h-12">
      <mat-icon class="!text-rose-600 dark:!text-rose-400">logout</mat-icon>
      <span class="font-semibold">Cerrar Sesi√≥n</span>
    </button>
  </mat-menu>

</div>